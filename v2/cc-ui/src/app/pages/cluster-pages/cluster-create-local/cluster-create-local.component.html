<app-layout-one-column>
  <nb-card>
    <nb-card-header>
      <nb-card-header *ngIf="!cluster?.id">Create Cluster for <b>{{stackName}}</b> stack on Local</nb-card-header>
      <nb-card-header *ngIf="cluster?.id">
        Update Cluster ({{ cluster?.name }} of <b>{{stackName}}</b> stack)
      </nb-card-header>
    </nb-card-header>
    <nb-card-body>
      <form #form="ngForm">
        <app-form-field label="Cluster Name" name="clusterName"
                        invalidMsg="Cluster Name is too Short or contains invalid characters (alphanumeric allowed)"
                        missingMsg="Cluster Name is required!" placeholder="Cluster Name"
                        tooltipText="Name to uniquely identify your cluster" pattern="[a-z-]+"
                        [(ngModel)]="awsClusterRequest.clusterName" required="true" minlength="5"
                        [disabled]="cluster?.id"></app-form-field>
        <nb-accordion multi class="col-md-12">
          <nb-accordion-item expanded>
            <nb-accordion-item-header>
              Common Variables
            </nb-accordion-item-header>
            <nb-accordion-item-body>
              <app-form-field *ngFor="let variable of dataSourceForCommonVars" [label]="variable.name"
                              [name]="variable.name" placeholder="Enter Value"
                              tooltipText="Cluster variables are common variables defined in stack.json, used across applications in cluster"
                              [(ngModel)]="variable.value" [required]="variable.required"></app-form-field>
            </nb-accordion-item-body>
          </nb-accordion-item>

          <nb-accordion-item expanded>
            <nb-accordion-item-header>
              Secrets
            </nb-accordion-item-header>
            <nb-accordion-item-body>
              <app-form-field *ngFor="let variable of dataSourceForSecrets" [label]="variable.name"
                              [name]="variable.name" placeholder="Enter Value"
                              tooltipText="Secrets are common secrets defined in stack.json, used across applications in cluster"
                              [(ngModel)]="variable.value" [required]="variable.required"></app-form-field>
            </nb-accordion-item-body>
          </nb-accordion-item>
        </nb-accordion>
      </form>
    </nb-card-body>
    <nb-card-footer *ngIf="!cluster?.id">
      <button class=" cc-margin-right" nbButton status="primary" (click)='createCluster()'
              [disabled]="!form.valid">Create
      </button>
    </nb-card-footer>
    <nb-card-footer *ngIf="cluster?.id">
      <button class=" cc-margin-right" nbButton status="primary" (click)='updateCluster()'
              [disabled]="!form.valid">Update
      </button>
      <!--button class=" cc-margin-right" status="basic" nbButton>Cancel</button-->
    </nb-card-footer>
  </nb-card>
</app-layout-one-column>
